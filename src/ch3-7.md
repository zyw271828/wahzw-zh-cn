# 多项式知识的简洁非交互式论证

我们现在准备来合并这个逐步演化出来的 *zk-SNARKOP* 协议。为简洁起见，我们将使用大括号来表示由旁边的下标填充的一组元素，例如：

$\{s^i\}_{i\in[d]}$

表示一组数 s<sup>1</sup>，s<sup>2</sup>， …， *s<sup>d</sup>* 。我们已经明确目标多项式 *t(x)* 和证明者的多项式阶数 *d*：

* Setup
  * 挑选随机值 *s*，*α*
  * 计算加密值 $g^α$ 和 $\{g^{s^i}\}_{i\in[d]}$，$\{g^{αs^i}\}_{i\in\{0,…,d\}}$
  * 生成 *proving key*：$(\{g^{s^i}\}_{i\in[d]},\{g^{αs^i}\}_{i\in\{0,…,d\}})$
  * 生成 *verification key*: $(g^α，g^{t(s)})$
* Proving
  * 分配系数 $\{c_i\}_{i\in\{0,…,d\}}$ (即知识)得 $p(x) = c_dx^d +…+ c_1x^1 + c_0x^0$
  * 求多项式 $h(x) = p(x)/t(x)$
  * 代入 $\{g^{s^i}\}_{i\in[d]}$ 计算多项式 $g^{p(s)}$ 和 $g^{h(s)}$ 的值
  * 代入 $\{g^{αs^i}\}_{i\in[d]}$ 计算变换多项式 $g^{αp(s)}$ 的值
  * 选择随机数 *δ*
  * 构造随机化的证明 $π = (g^{δp(s)},g^{δh(s)},g^{δαp(s)})$
* verification
  * 映射证明 *π* 为 $(g^p,g^h,g^{p'})$
  * 验证多项式约束：$e(g^{p'},g) = e(g^p,g^α)$
  * 验证多项式系数：$e(g^p,g) = e(g^{t(s)},g^h)$

**备注 3.3** 如果 pairing 的结果有可能在其它类似的乘法协议中被复用，那么这里就完全没有安全性可言了，因为这样的话证明者就可以构造

$g^{p'} = e(g^p,g^α)$

这样也可以通过"多项式约束"的检查：

$e(e(g^p,g^α)，g) = e(g^p,g^α)$
